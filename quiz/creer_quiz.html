<!DOCTYPE html>
<html>
<head>
    <title>Quiz Admin - Ajout Question Textuelle</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        label { display: block; margin-top: 10px; }
        input[type="text"] { width: 300px; padding: 5px; margin-bottom: 10px; }
        button { padding: 10px 20px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #45a049; }
    </style>
</head>
<body>
    <h1>Ajouter une Question à Réponse Textuelle</h1>

    <div id="app">
        <label for="questionText">Texte de la question:</label>
        <input type="text" id="questionText" placeholder="Ex: Quelle est la capitale de la France ?"><br>

        <label for="correctAnswerText">Bonne réponse (texte):</label>
        <input type="text" id="correctAnswerText" placeholder="Ex: Paris"><br>

        <button id="addQuestionBtn">Ajouter la Question</button>
    </div>

   <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyB29fMpTwBgsqkjijkNoQJ2kGChSeQDX_w",
        authDomain: "quiz-ea203.firebaseapp.com",
        projectId: "quiz-ea203",
        storageBucket: "quiz-ea203.firebasestorage.app",
        messagingSenderId: "605137421110",
        appId: "1:605137421110:web:289e0876fe06108deaa997",
        measurementId: "G-8JVMQRJTD5"
    };

    // --- CORRECTION : Initialisation ---
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);

    const addQuestionBtn = document.getElementById('addQuestionBtn');

    addQuestionBtn.addEventListener('click', () => {
        const questionText = document.getElementById('questionText').value.trim();
        const correctAnswerText = document.getElementById('correctAnswerText').value.trim();

        if (!questionText || !correctAnswerText) {
            alert("Veuillez remplir tous les champs de la question.");
            return;
        }

        const newQuestion = {
            text: questionText,
            type: "textAnswer",
            correctAnswerText: correctAnswerText
        };

        addQuestionToDatabase(newQuestion);
    });

    async function addQuestionToDatabase(questionData) {
        try {
            // --- CORRECTION : Syntaxe Modulaire v9 ---
            const questionsListRef = ref(database, 'questions');
            const newQuestionRef = push(questionsListRef);
            
            await set(newQuestionRef, questionData);
            
            console.log("Question ajoutée ! ID:", newQuestionRef.key);

            document.getElementById('questionText').value = '';
            document.getElementById('correctAnswerText').value = '';
            alert("Question textuelle ajoutée avec succès !");
            
        } catch (error) {
            console.error("Erreur :", error);
            alert("Erreur lors de l'ajout. Vérifiez les règles de sécurité Firebase.");
        }
    }
</script>
</body>
</html>

